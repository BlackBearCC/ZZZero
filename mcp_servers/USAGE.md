# è§’è‰²æ‰®æ¼”æ•°æ®ç”ŸæˆæœåŠ¡ä½¿ç”¨æŒ‡å—

## ğŸš€ å¿«é€Ÿå¼€å§‹

### 1. æœ¬åœ°æµ‹è¯•æ¨¡å¼
```bash
cd mcp_servers
python roleplay_data_server.py --test
```

è¿™å°†å¯åŠ¨æœ¬åœ°æµ‹è¯•æ¨¡å¼ï¼Œè‡ªåŠ¨æ¼”ç¤ºå®Œæ•´çš„æ—¥ç¨‹ç”Ÿæˆæµç¨‹ï¼š
- è‡ªåŠ¨é…ç½®çŸ¥è¯†åº“ï¼ˆåŠ è½½ roleplay_data_README.mdï¼‰
- ç”Ÿæˆæ—¥ç¨‹è®¡åˆ’æ¡†æ¶
- ç”Ÿæˆè¯¦ç»†5é˜¶æ®µæ—¥ç¨‹
- å±•ç¤ºè§’è‰²æ’ä»¶çš„ä½¿ç”¨æ•ˆæœ

### 2. MCPæœåŠ¡å™¨æ¨¡å¼
```bash
cd mcp_servers
python roleplay_data_server.py
```

å¯åŠ¨æ ‡å‡†çš„MCPæœåŠ¡å™¨ï¼Œå¯ä»¥é€šè¿‡MCPåè®®ä¸å…¶ä»–åº”ç”¨é›†æˆã€‚

## ğŸ­ è§’è‰²æ’ä»¶é›†æˆ

### è‡ªåŠ¨åŠŸèƒ½
æœåŠ¡å¯åŠ¨æ—¶ä¼šè‡ªåŠ¨ï¼š
1. **åˆå§‹åŒ–è§’è‰²æ’ä»¶ç®¡ç†å™¨**
2. **é…ç½®çŸ¥è¯†åº“**ï¼šå°† `roleplay_data_README.md` åŠ è½½ä¸ºçŸ¥è¯†åº“
3. **å¯ç”¨å‘é‡æœç´¢**ï¼šæ”¯æŒåŸºäºå…³é”®è¯çš„æ™ºèƒ½æœç´¢

### å¢å¼ºæ•ˆæœ
- **è§’è‰²èµ„æ–™**ï¼šè‡ªåŠ¨æ³¨å…¥åˆ° `character_description` å‚æ•°
- **çŸ¥è¯†åº“æœç´¢**ï¼šæ ¹æ® `requirements` æå–å…³é”®è¯ï¼Œæœç´¢ç›¸å…³çŸ¥è¯†å¹¶æ³¨å…¥

## ğŸ“‹ ç”Ÿæˆæµç¨‹

### ç¬¬ä¸€æ­¥ï¼šæ—¥ç¨‹è®¡åˆ’æ¡†æ¶
```python
# è°ƒç”¨ generate_schedule_plan
result = await generator.generate_schedule_plan(
    character_description="è§’è‰²è®¾å®š...",
    requirements="éœ€æ±‚æè¿°..."
)
```

**æ’ä»¶å¢å¼º**ï¼š
- å¦‚æœé…ç½®äº†è§’è‰²èµ„æ–™æ’ä»¶ â†’ è‡ªåŠ¨è¡¥å……è§’è‰²ä¿¡æ¯
- å¦‚æœé…ç½®äº†çŸ¥è¯†åº“æ’ä»¶ â†’ æœç´¢ç›¸å…³çŸ¥è¯†å¹¶æ·»åŠ åˆ°éœ€æ±‚ä¸­

### ç¬¬äºŒæ­¥ï¼šè¯¦ç»†5é˜¶æ®µæ—¥ç¨‹
```python
# è°ƒç”¨ generate_detailed_schedule
result = await generator.generate_detailed_schedule(
    character_description="è§’è‰²è®¾å®š...",
    plan_framework="ç¬¬ä¸€æ­¥çš„è®¡åˆ’æ¡†æ¶",
    requirements="è¡¥å……éœ€æ±‚..."
)
```

**æ’ä»¶å¢å¼º**ï¼š
- å†æ¬¡åº”ç”¨è§’è‰²æ’ä»¶å¢å¼º
- ç”ŸæˆåŒ…å«åœ°ç‚¹ã€å¤©æ°”ã€æƒ…ç»ªçš„è¯¦ç»†æ—¥ç¨‹

## ğŸ”§ ç¯å¢ƒé…ç½®

### å¿…éœ€çš„ç¯å¢ƒå˜é‡
```bash
# LLMæä¾›å•†é…ç½®
LLM_PROVIDER=doubao                    # æˆ– openai
ARK_API_KEY=your_api_key              # è±†åŒ…APIå¯†é’¥
# æˆ–
OPENAI_API_KEY=your_api_key           # OpenAI APIå¯†é’¥
```

### å¯é€‰çš„ç¯å¢ƒå˜é‡
```bash
LLM_MODEL_NAME=ep-20250221154410-vh78x  # æŒ‡å®šæ¨¡å‹
DOUBAO_BASE_URL=https://ark.cn-beijing.volces.com/api/v3  # APIåŸºç¡€URL
```

## ğŸ“Š è¿”å›æ•°æ®æ ¼å¼

### æ—¥ç¨‹è®¡åˆ’æ¡†æ¶ç»“æœ
```json
{
  "generation_id": "plan_1703123456",
  "type": "schedule_plan",
  "success": true,
  "content": "ç”Ÿæˆçš„è®¡åˆ’æ¡†æ¶å†…å®¹...",
  "character_description": "åŸå§‹è§’è‰²æè¿°",
  "enhanced_character_description": "æ’ä»¶å¢å¼ºåçš„è§’è‰²æè¿°",
  "requirements": "åŸå§‹éœ€æ±‚",
  "enhanced_requirements": "æ’ä»¶å¢å¼ºåçš„éœ€æ±‚",
  "role_plugin_used": true,
  "generation_time": 2.5,
  "generated_at": "2023-12-21T10:30:00",
  "completed_at": "2023-12-21T10:30:02"
}
```

### è¯¦ç»†æ—¥ç¨‹ç»“æœ
```json
{
  "generation_id": "schedule_1703123456",
  "type": "detailed_schedule",
  "success": true,
  "content": "ç”Ÿæˆçš„è¯¦ç»†æ—¥ç¨‹å†…å®¹...",
  "phases_data": {
    "morning": {
      "name": "ä¸Šåˆ",
      "time_range": "06:00-11:00",
      "activities": [
        {
          "activity_name": "æ™¨é—´é˜…è¯»",
          "details": "åœ¨å’–å•¡åº—é˜…è¯»å¤©æ–‡å­¦ç›¸å…³ä¹¦ç±...",
          "location": "å’–å•¡å…",
          "weather": "é˜³å…‰æ˜åªš",
          "emotion": "å¹³é™"
        }
      ]
    }
    // ... å…¶ä»–æ—¶é—´æ®µ
  },
  "role_plugin_used": true,
  "generation_time": 3.2
}
```

## ğŸ¯ ä½¿ç”¨åœºæ™¯

### 1. è§’è‰²æ‰®æ¼”æ¸¸æˆ
- ä¸ºNPCç”Ÿæˆè¯¦ç»†çš„æ—¥ç¨‹å®‰æ’
- åŸºäºè§’è‰²èƒŒæ™¯åˆ›å»ºçœŸå®çš„ç”Ÿæ´»èŠ‚å¥

### 2. æ•…äº‹åˆ›ä½œ
- ä¸ºå°è¯´è§’è‰²è®¾è®¡æ—¥å¸¸ç”Ÿæ´»
- ç¡®ä¿è§’è‰²è¡Œä¸ºç¬¦åˆè®¾å®š

### 3. æ—¶é—´ç®¡ç†
- ç”Ÿæˆä¸ªæ€§åŒ–çš„æ—¥ç¨‹è§„åˆ’
- ç»“åˆä¸ªäººç‰¹ç‚¹çš„æ—¶é—´å®‰æ’

## ğŸ” è°ƒè¯•å’Œæ—¥å¿—

### å¯ç”¨è¯¦ç»†æ—¥å¿—
```bash
export PYTHONPATH=.
python -m logging --level=DEBUG mcp_servers/roleplay_data_server.py --test
```

### å…³é”®æ—¥å¿—ä¿¡æ¯
- `âœ… å·²ä»è§’è‰²èµ„æ–™æ’ä»¶è·å–è§’è‰²ä¿¡æ¯`
- `âœ… å·²ä»çŸ¥è¯†åº“æ’ä»¶è·å– X æ¡ç›¸å…³çŸ¥è¯†`
- `âœ… å·²è‡ªåŠ¨é…ç½®è§’è‰²æ‰®æ¼”æ•°æ®ç”ŸæˆæœåŠ¡çŸ¥è¯†åº“`

## âš ï¸ æ³¨æ„äº‹é¡¹

1. **é¦–æ¬¡è¿è¡Œ**ï¼šçŸ¥è¯†åº“åˆå§‹åŒ–éœ€è¦æ—¶é—´ï¼Œè¯·è€å¿ƒç­‰å¾…
2. **APIé…ç½®**ï¼šç¡®ä¿LLM APIå¯†é’¥æ­£ç¡®é…ç½®
3. **ç½‘ç»œè¿æ¥**ï¼šéœ€è¦ç¨³å®šçš„ç½‘ç»œè¿æ¥è®¿é—®LLMæœåŠ¡
4. **èµ„æºå ç”¨**ï¼šçŸ¥è¯†åº“å‘é‡åŒ–ä¼šå ç”¨ä¸€å®šçš„å†…å­˜å’Œå­˜å‚¨ç©ºé—´

## ğŸ› ï¸ æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜

**Q: çŸ¥è¯†åº“åˆå§‹åŒ–å¤±è´¥**
```bash
# æ£€æŸ¥æ–‡ä»¶æ˜¯å¦å­˜åœ¨
ls -la mcp_servers/roleplay_data_README.md

# æ£€æŸ¥æƒé™
chmod 644 mcp_servers/roleplay_data_README.md
```

**Q: LLMè°ƒç”¨å¤±è´¥**
```bash
# æ£€æŸ¥ç¯å¢ƒå˜é‡
echo $ARK_API_KEY
echo $LLM_PROVIDER

# æµ‹è¯•ç½‘ç»œè¿æ¥
curl -I https://ark.cn-beijing.volces.com
```

**Q: è§’è‰²æ’ä»¶æœªç”Ÿæ•ˆ**
- ç¡®ä¿ `workspace/` ç›®å½•å­˜åœ¨ä¸”å¯å†™
- æ£€æŸ¥ `workspace/role_plugins_config.json` é…ç½®æ–‡ä»¶
- æŸ¥çœ‹æ—¥å¿—ä¸­æ˜¯å¦æœ‰è§’è‰²æ’ä»¶ç›¸å…³çš„é”™è¯¯ä¿¡æ¯

## ğŸ“ æ”¯æŒ

å¦‚æœé‡åˆ°é—®é¢˜ï¼Œè¯·æŸ¥çœ‹ï¼š
1. æ§åˆ¶å°æ—¥å¿—è¾“å‡º
2. `workspace/` ç›®å½•ä¸‹çš„é…ç½®æ–‡ä»¶
3. ç¯å¢ƒå˜é‡é…ç½®æ˜¯å¦æ­£ç¡® 