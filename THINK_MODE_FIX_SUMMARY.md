# Thinkæ¨¡å¼ä¿®å¤æ€»ç»“

## ğŸ› å‘ç°çš„é—®é¢˜

### 1. LLM Thinkæ¨¡å¼è¾“å‡ºæ ¼å¼ä¸åŒ¹é…
- **é—®é¢˜**ï¼šå·¥ä½œæµæœŸæœ›ä»LLMè·å¾—å­—å…¸æ ¼å¼ `{"think": "æ€è€ƒå†…å®¹", "content": "æ­£å¼å†…å®¹"}`
- **å®é™…**ï¼šLLMçš„stream_generateåœ¨thinkæ¨¡å¼ä¸‹åªè¿”å›å­—ç¬¦ä¸²
- **å½±å“**ï¼šå·¥ä½œæµæ— æ³•åŒºåˆ†æ€è€ƒè¿‡ç¨‹å’Œæ­£å¼ç»“æœ

### 2. å‰§æƒ…ç”ŸæˆèŠ‚ç‚¹æ•°æ®ä¼ é€’å¤±è´¥
- **é—®é¢˜**ï¼šplanning_resultä¸ºç©ºï¼Œå¯¼è‡´å‰§æƒ…ç”Ÿæˆå¤±è´¥
- **åŸå› **ï¼šæ•°æ®åœ¨èŠ‚ç‚¹é—´ä¼ é€’æ—¶ä¸¢å¤±
- **æ—¥å¿—**ï¼š`å‰§æƒ…ç”Ÿæˆå¤±è´¥ï¼šç¼ºå°‘å‰§æƒ…è§„åˆ’ç»“æœ`

### 3. å˜é‡åˆå§‹åŒ–é—®é¢˜
- **é—®é¢˜**ï¼šä»£ç ä¸­å¼•ç”¨äº†æœªåˆå§‹åŒ–çš„`full_content`å˜é‡
- **å½±å“**ï¼šå¯èƒ½å¯¼è‡´è¿è¡Œæ—¶é”™è¯¯

## ğŸ”§ ä¿®å¤æ–¹æ¡ˆ

### 1. ä¿®æ”¹LLM stream_generateæ–¹æ³•
```python
async def stream_generate(self, messages, mode="normal", return_dict=False, **kwargs):
    if mode == "think":
        if return_dict:
            # å·¥ä½œæµä½¿ç”¨ï¼šè¿”å›å­—å…¸æ ¼å¼
            yield {"think": reasoning_chunk, "content": "", "type": "reasoning_chunk"}
            yield {"think": "", "content": content_chunk, "type": "content_chunk"}
        else:
            # æ™®é€šèŠå¤©ä½¿ç”¨ï¼šè¿”å›å­—ç¬¦ä¸²æ ¼å¼
            yield reasoning_chunk
            yield content_chunk
```

### 2. å·¥ä½œæµè°ƒç”¨æ—¶ä¼ é€’return_dict=True
```python
async for chunk_data in llm.stream_generate(
    messages, 
    mode="think",
    return_dict=True  # ç¡®ä¿è·å¾—å­—å…¸æ ¼å¼
):
```

### 3. æ·»åŠ è°ƒè¯•æ—¥å¿—
- åœ¨å‰§æƒ…è§„åˆ’å®Œæˆæ—¶è¾“å‡ºfinal_contenté•¿åº¦
- åœ¨å‰§æƒ…ç”Ÿæˆå¼€å§‹æ—¶è¾“å‡ºæ¥æ”¶åˆ°çš„input_dataé”®
- éªŒè¯planning_resultçš„ä¼ é€’æƒ…å†µ

## âœ… ä¿®å¤æ•ˆæœ

### Thinkæ¨¡å¼æ­£ç¡®åŒºåˆ†
- ğŸ¤” æ€è€ƒè¿‡ç¨‹ï¼šç°è‰²è¾¹æ¡†æ ·å¼æ˜¾ç¤º
- ğŸ“‹ è§„åˆ’ç»“æœï¼šç»¿è‰²è¾¹æ¡†æ ·å¼æ˜¾ç¤º
- åªå°†æ­£å¼ç»“æœä¼ é€’ç»™ä¸‹æ¸¸èŠ‚ç‚¹

### æ•°æ®ä¼ é€’å®Œæ•´
- planning_resultæ­£ç¡®ä¼ é€’åˆ°å‰§æƒ…ç”ŸæˆèŠ‚ç‚¹
- åŒ…å«å®Œæ•´çš„ç”¨æˆ·é…ç½®å’Œè§’è‰²ä¿¡æ¯
- æ”¯æŒè°ƒè¯•å’Œé”™è¯¯è¿½è¸ª

### å…¼å®¹æ€§ä¿æŒ
- æ™®é€šèŠå¤©ä»ä½¿ç”¨å­—ç¬¦ä¸²æ ¼å¼
- å·¥ä½œæµä½¿ç”¨å¢å¼ºçš„å­—å…¸æ ¼å¼
- ä¸å½±å“ç°æœ‰åŠŸèƒ½

## ğŸ§ª æµ‹è¯•éªŒè¯

åˆ›å»ºäº†æµ‹è¯•è„šæœ¬ `test_think_debug.py` æ¥éªŒè¯ï¼š
- æ™®é€šæ¨¡å¼è¿”å›å­—ç¬¦ä¸²
- å·¥ä½œæµæ¨¡å¼è¿”å›å­—å…¸
- Thinkå’ŒContentæ­£ç¡®åˆ†ç¦»

## ğŸ“‹ å‰©ä½™å·¥ä½œ

å¦‚æœé—®é¢˜ä»ç„¶å­˜åœ¨ï¼Œéœ€è¦è¿›ä¸€æ­¥æ£€æŸ¥ï¼š
1. StateGraphçš„èŠ‚ç‚¹é—´æ•°æ®ä¼ é€’æœºåˆ¶
2. yieldè¾“å‡ºçš„æ•°æ®ç»“æ„
3. æœ€ç»ˆè¾“å‡ºæ•°æ®çš„å®Œæ•´æ€§ 