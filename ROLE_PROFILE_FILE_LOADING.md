# 角色资料文件加载功能使用说明

## 功能概述

ZZZero AI Agent 现在支持从文件加载角色资料，用户可以上传 txt 格式的角色设定文件，系统会自动读取文件内容并显示在文本输入框中，允许用户继续编辑。

## 使用步骤

### 1. 准备角色资料文件
- 创建一个 `.txt` 格式的文件
- 文件内容包含角色的详细设定信息
- 支持中文内容，建议使用 UTF-8 编码保存

### 2. 上传和加载文件
1. 打开 Web 界面，在左侧配置面板找到 **"🎭 角色插件配置"** 区域
2. 在 **"📝 角色资料配置"** 部分，切换到 **"文件上传"** 标签页
3. 点击 **"选择角色资料文件（txt格式）"** 按钮选择本地文件
4. 点击 **"📥 从文件加载角色资料"** 按钮

### 3. 查看和编辑内容
1. 加载成功后，切换到 **"文本输入"** 标签页
2. 文件内容会自动显示在文本框中，包含：
   - 文件加载信息（文件名、大小、编码）
   - 原始文件内容
3. 可以直接在文本框中编辑内容

## 功能特性

### ✅ 支持的文件格式
- `.txt` 文本文件

### ✅ 支持的编码格式
- UTF-8（推荐）
- UTF-8 with BOM
- GBK / GB2312 / GB18030
- UTF-16

### ✅ 文件大小限制
- 最大支持 5MB 的文件

### ✅ 智能处理
- 自动检测文件编码
- 自动清理多余空白字符
- 提供详细的加载信息和错误提示

## 使用示例

### 示例文件内容（基础人设.txt）
```
方知衡：基础人设
姓名：方知衡，英文名 Ordinis
性别：男
年龄：28岁
身高/体重：185cm/70kg
血型：A型
生日：1月19日
星座：摩羯座
职业：
云枢大学天文系客座教授、博士
香丘天文院宇宙物质专项课题研究员之一

角色特征
静态性格
方知衡是一个秉持平等理念的人，无论面对伴侣、学生还是小孩，他都主张相互理解与尊重...
```

### 加载后的显示效果
```
# 📄 已从文件加载：基础人设.txt
# 📊 文件大小：9.1KB | 编码：utf-8
# ✅ 加载成功，您可以继续编辑内容

方知衡：基础人设
姓名：方知衡，英文名 Ordinis
性别：男
年龄：28岁
...（原文件内容）
```

## 错误处理

### 常见错误信息及解决方法

| 错误信息 | 原因 | 解决方法 |
|---------|------|---------|
| ❌ 请先选择文件 | 未选择文件就点击加载 | 先选择文件再点击加载按钮 |
| ❌ 文件不存在，请重新选择文件 | 文件路径无效 | 重新选择有效的文件 |
| ❌ 文件为空，请选择有内容的文件 | 选择的文件没有内容 | 选择包含内容的文件 |
| ❌ 文件过大（X.XMB），请选择小于5MB的文件 | 文件超过大小限制 | 选择较小的文件或分割内容 |
| ❌ 无法读取文件，请检查文件编码格式 | 文件编码不支持 | 将文件转换为UTF-8编码 |
| ❌ 文件内容为空或只包含空白字符 | 文件只有空格、换行等 | 添加实际内容到文件 |

## 最佳实践

### 1. 文件准备建议
- 使用 UTF-8 编码保存文件，确保中文正常显示
- 合理组织内容结构，便于后续编辑
- 控制文件大小在 5MB 以内

### 2. 使用流程建议
1. 先在"文件上传"标签页加载文件
2. 切换到"文本输入"标签页查看和编辑
3. 根据需要调整内容
4. 填写角色名称和标签
5. 点击"保存角色插件配置"完成设置

### 3. 内容编辑技巧
- 加载的文件会在开头添加加载信息，可以删除这些注释行
- 可以直接在文本框中修改、添加或删除内容
- 支持 Markdown 格式，可以使用标题、列表等格式

## 集成使用

加载角色资料后：

1. **启用角色资料插件**：勾选"启用角色资料插件"
2. **填写角色名称**：例如"方知衡"
3. **添加角色标签**：例如"温柔,聪明,天文学家"
4. **保存配置**：点击"保存角色插件配置"

配置完成后，在使用角色扮演相关工具时，系统会自动注入这些角色信息，提升AI的角色一致性。

## 技术实现

- 支持多种编码格式的自动检测
- 文件大小和内容验证
- 错误处理和用户友好的提示信息
- 与现有角色插件系统的无缝集成 